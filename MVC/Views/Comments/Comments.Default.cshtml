@model Telerik.Sitefinity.Frontend.Comments.Mvc.Models.CommentsListViewModel

@using Telerik.Sitefinity.Frontend.Mvc.Helpers;
@using Telerik.Sitefinity.Modules.Pages;

@Html.Script(ScriptRef.JQuery, "top", false)

<div id="comments-@HttpUtility.HtmlEncode(Model.ThreadKey)" data-sf-role="comments-wrapper" class="@Model.CssClass sf-Comments">
    <input type="hidden" data-sf-role="comments-settings" value="@Model.SerializedWidgetSettings" />
    <input type="hidden" data-sf-role="comments-resources" value="@Model.SerializedWidgetResources" />

    <h2>Comments</h2>
    <h3>
        <span data-sf-role="comments-total-count"></span>
        <span data-sf-role="comments-header"></span>
    </h3>

    @if (!Model.ThreadIsClosed) {
        <a href="#comment-submit-@HttpUtility.HtmlEncode(HttpUtility.UrlEncode(Model.ThreadKey))" data-sf-role="comments-new-form-button">@Html.Resource("LeaveComment")</a>
    }

    <div class="comments-header">
        <a href="#" data-sf-role="comments-sort-new-button">@Html.Resource("NewestOnTop")</a>
        <a href="#" data-sf-role="comments-sort-old-button">@Html.Resource("OldestOnTop")</a>
    </div>
          
    <div data-sf-role="list-loading-indicator" class="sf-loading" style="display:none;"><span></span></div>

    <div data-sf-role="comments-container" class="comments container"></div>

    @if(Model.EnablePaging) {
        <a href="#" data-sf-role="comments-load-more-button" class="sf-Comments-more">@Html.Resource("LoadMoreComments")</a>
    }

    @if (Model.ThreadIsClosed) {
        <div class="alert alert-warning">@Html.Resource("CommentsThreadIsClosedMessage")</div>
    } else {   
        <h3>@Html.Resource("LeaveComment")</h3> 

        <div class="container comment-add">    
            <div data-sf-role="comments-new-form" id="comment-submit-@HttpUtility.HtmlEncode(Model.ThreadKey)" >
                @if (Model.RequiresApproval) {
                    <div class="alert alert-warning" data-sf-role="comments-new-pending-approval-message">@Html.Resource("CommentPendingApproval")</div>
                }

                <div class="row">

                    <div class="col-md-1">
                        <img src="@Model.UserAvatarImageUrl" width="40" height="40"/>
                    </div>

                    <div class="col-md-11">
                        <div class="form-group">
                            <label>
                                <span class="visually-hidden">@Html.Resource("LeaveComment")</span>
                                <span class="visually-hidden">(Required)</span>
                                <textarea class="form-control" data-sf-role="comments-new-message" placeholder="@Html.Resource("LeaveComment")" ></textarea>
                            </label>
                        </div>

                        <div data-sf-role="comments-new-logged-out-view" class="row" style="display:none;">
                            <div class="col-md-8">
                                <div class="form-group">
                                    <label>
                                        <span class="form-control-label required-indicator">@Html.Resource("YourName")</span>
                                        <span class="visually-hidden">(Required)</span>
                                        <input type="text" placeholder="@Html.Resource("YourName")" data-sf-role="comments-new-name" class="form-control" />
                                    </label>
                                </div>

                                <div class="form-group">
                                    <label>
                                        <span class="form-control-label">@Html.Resource("EmailOptional")</span>
                                        <input type="email" placeholder="@Html.Resource("EmailOptional")" data-sf-role="comments-new-email" class="form-control" /> 
                                    </label>
                                </div>
                           </div>  
                        </div>
            
                        @if (Model.RequiresCaptcha) {
                            <div data-sf-role="captcha-container" class="sf-Comments-captcha">
                                <div>
                                    <img data-sf-role="captcha-image" src="@Url.WidgetContent("assets/dist/img/dummy.jpg")" />
                                </div>

                                <a data-sf-role="captcha-refresh-button"> @Html.Resource("NewCode") </a>

                                <div class="form-inline">
                                    <div class="form-group">
                                        <label>@Html.Resource("TypeCodeAbove")</label>
                                        <input type="text" data-sf-role="captcha-input" class="form-control input-sm"/>
                                    </div>
                                </div>
                            </div>
                        }

                        <div><button class="btn btn-primary" data-sf-role="comments-new-submit-button">@Html.Resource("Submit")</button></div>
                    </div>
                </div>
            </div>

            @if (Model.AllowSubscription) {
                <div class="sf-Comment-subscribe">
                    <span data-sf-role="comments-subscribe-text"></span>
                    <a href="#" data-sf-role="comments-subscribe-button">
                        <span class="sf-icon-email"></span>
                        <span data-sf-role="comments-subscribe-button-text"></span>
                    </a>
                </div>
            }

            <div data-sf-role="error-message" class="error-message">
                <span class="help-block"></span>
            </div>
					
            <div data-sf-role="list-loading-indicator" class="sf-loading" style="display:none;">
				<span></span>
			</div>
       </div>

        if (Model.RequiresAuthentication) {
            <div class="alert alert-warning" data-sf-role="comments-new-requires-authentication"><a href='@Model.LoginPageUrl'>@Html.Resource("Login")</a>@Html.Resource("ToBeAbleToComment")</div>
        }
    }
    
    @*Single comment template*@

    <div data-sf-role="single-comment-template">
        <div class="row comment" >
            <div class="col-md-1"> 
                <img alt="comment-avatar" data-sf-role="comment-avatar" width="40" height="40" src="@Url.WidgetContent("assets/dist/img/dummy.jpg")"/>
            </div>
            <div class="col-md-11">
                <strong data-sf-role="comment-name" class="text-muted sf-Comments-list-author"></strong> - <em property="dateCreated" data-sf-role="comment-date" class="text-muted"></em>
                <p class="comments-message" data-sf-role="comment-message"></p>
            </div>  
        </div>  
    </div>
</div>

@Html.Script(Url.WidgetContent("Mvc/Scripts/comments-list.js"), "bottom", false)